import{_ as t,c as e,o as a,a4 as s}from"./chunks/framework.DkZrsx35.js";const l="/web/assets/image-14.DdyDjh9J.png",r="/web/assets/image-15._TkSLdIK.png",o="/web/assets/20241009_231856_image.GOKZp97v.png",b=JSON.parse('{"title":"分析 CSS 选择器性能","description":"","frontmatter":{},"headers":[],"relativePath":"devtools/css.md","filePath":"devtools/css.md"}'),d={name:"devtools/css.md"},i=s('<h1 id="分析-css-选择器性能" tabindex="-1">分析 CSS 选择器性能 <a class="header-anchor" href="#分析-css-选择器性能" aria-label="Permalink to &quot;分析 CSS 选择器性能&quot;">​</a></h1><h2 id="重新计算样式事件" tabindex="-1">重新计算样式事件 <a class="header-anchor" href="#重新计算样式事件" aria-label="Permalink to &quot;重新计算样式事件&quot;">​</a></h2><p>Performance 面板用右上角的红色三角形标记每个长时间运行的任务，并在 Summary 标签页中显示一条警告，表明主线程上需要很长时间才能运行且性能缓慢的工作： <img src="'+l+'" alt="alt text"></p><p>在性能记录中，其中一些长时间运行的任务可能是重新计算样式事件。重新计算样式事件会跟踪浏览器执行以下操作所需的时间：</p><ul><li>遍历页面上的 DOM 元素，以查找与指定元素匹配的所有 CSS 样式规则。</li><li>根据匹配的 CSS 样式规则，计算每个元素的实际样式。</li></ul><p>当 CSS 规则的适用性发生变化时，需要重新计算 CSS 样式，例如：</p><ul><li>向 DOM 中添加元素或从中移除元素。</li><li>更改元素的属性，例如类或 ID 属性的值。</li><li>用户做出输入（例如移动鼠标或更改元素焦点），这些都会影响 :hover 规则。</li></ul><h2 id="开启-css-选择器统计信息" tabindex="-1">开启 CSS 选择器统计信息 <a class="header-anchor" href="#开启-css-选择器统计信息" aria-label="Permalink to &quot;开启 CSS 选择器统计信息&quot;">​</a></h2><p>在 Performance（性能）面板中，点击 settings 按钮，然后选中 Enable CSS Selector stats（启用 CSS 选择器统计信息）</p><p>在性能记录中找到 Recalculate Style 事件，然后点击该事件 <img src="'+r+'" alt="alt text"></p><table><thead><tr><th>列</th><th>说明</th></tr></thead><tbody><tr><td>用时（毫秒）</td><td>浏览器匹配此 CSS 选择器所用的时间。此时间以毫秒 (ms) 为单位，其中 1 毫秒为 1/1000 秒。</td></tr><tr><td>尝试匹配次数</td><td>浏览器引擎尝试与此 CSS 选择器匹配的元素数量。</td></tr><tr><td>匹配数</td><td>浏览器引擎与此 CSS 选择器匹配的元素数量。</td></tr><tr><td>慢路径不匹配项所占百分比</td><td>与此 CSS 选择器不匹配的元素与浏览器引擎尝试匹配的元素之间的比率，以及浏览器引擎使用优化程度较低的代码进行匹配的元素所占的比例。</td></tr><tr><td>选择器</td><td>匹配的 CSS 选择器。</td></tr><tr><td>样式表</td><td>包含 CSS 选择器的 CSS 样式表。</td></tr></tbody></table><p>要尝试提升网页性能，请重点关注符合以下条件的 CSS 选择器：</p><ul><li>计算时间过长（<strong>用时（毫秒）</strong> 值较高）。</li><li>浏览器尝试匹配多次（<strong>匹配尝试次数</strong> 值较高）。</li><li>浏览器实际上并未匹配多个元素（与“Match Attempts”值相比，“Match Count”值较低）。</li><li>慢路径不匹配项占比较高。</li></ul><p>例如，在上一个屏幕截图中：</p><ul><li>第一个 CSS 选择器 (<code>html body .ps[tooltip...</code>) 需要的时间最多。</li><li>浏览器引擎尝试匹配此 CSS 选择器 1104 次，但与任何元素都不匹配。</li></ul><p><img src="'+o+'" alt=""></p>',16),S=[i];function c(n,p,_,h,m,C){return a(),e("div",null,S)}const g=t(d,[["render",c]]);export{b as __pageData,g as default};
